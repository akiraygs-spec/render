import streamlit as st

class CounselingBot:
    def __init__(self):
        try:
            self.api_key = st.secrets.get("OPENAI_API_KEY", "")
        except:
            self.api_key = ""
        
    def get_counseling_response(self, content: str, mood: str, mood_intensity: int, category: str) -> str:
        intensity_responses = {
            0: "今はとても辛い時期ですね。あなたの痛みを心から受け止めています。一人ではありません。",
            1: "大変な気持ちですね。そんな日もあります。無理をせず、自分を労ってあげてください。",
            2: "少し重い気持ちなのですね。ゆっくりと深呼吸をして、今この瞬間を大切にしましょう。",
            3: "穏やかな心持ちですね。この平静さを大切に、今日を過ごしてください。",
            4: "良い気分のようですね。その明るい気持ちが、周りにも温かさを届けています。",
            5: "素晴らしい気持ちが伝わってきます！この喜びを心に刻んで、明日への力にしてください。"
        }
        
        base_response = intensity_responses.get(mood_intensity, "あなたの気持ちに、静かに寄り添っています。")
        
        category_advice = {
            "仕事・学業": "一歩ずつ、あなたのペースで進んでいけば大丈夫です。目標に向かって着実に歩んでいきましょう。",
            "人間関係": "人との関わりは複雑ですが、あなたの誠実さは必ず相手に伝わります。自分らしさを大切にしてください。",
            "恋愛": "心を開くことは勇気がいりますが、真っ直ぐな気持ちは美しいものです。時間をかけて育んでいきましょう。",
            "家族": "家族だからこそ難しい面もありますね。お互いを思いやる気持ちがあれば、きっと理解し合えます。",
            "健康": "心と体の声に耳を傾けることは大切です。無理をせず、自分に優しくしてあげてください。",
            "その他": "どんな気持ちも、あなたにとって大切な感情です。その気持ちを大切にしながら歩んでいきましょう。"
        }
        
        advice = category_advice.get(category, "あなたなりのペースで、ゆっくりと歩んでいけば大丈夫です。")
        
        return f"{base_response}\n\n{advice}\n\n今日も一日お疲れ様でした。あなたの成長を応援しています。"